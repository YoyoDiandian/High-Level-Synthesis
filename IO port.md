# I/O Port Documentation for HLS Tool Chain

## Overview

This document describes the standard I/O ports of Verilog modules generated by our High-Level Synthesis (HLS) tool chain. The tool transforms LLVM IR into synthesizable Verilog code with standardized interfaces to facilitate integration into larger hardware systems.

## Standard Module Interface

Each generated Verilog module follows a consistent I/O port structure based on the input LLVM IR function signature.

### System Ports

| Port Name | Direction | Width | Description |
|-----------|-----------|-------|-------------|
| `sys_clk` | input | 1 bit | System clock signal |
| `sys_rst_n` | input | 1 bit | Active-low synchronous reset signal |

### Function-Specific Ports

#### Scalar Parameters
For each non-array parameter in the LLVM IR function:

| Port Name | Direction | Width | Description |
|-----------|-----------|-------|-------------|
| `param_name` | input | 32 bits | Input parameter value (e.g., `a`, `b`, `n`) |

#### Array Parameters
Array parameters are handled internally using memory structures rather than I/O ports:

```verilog
reg [31:0] array_name_mem [0:255];
```

These memory arrays are initialized during simulation by reading hex data from files:

```verilog
$readmemh("../../example/testbench/function_name/array_name.txt", array_name_mem);
```

#### Return Value

| Port Name | Direction | Width | Description |
|-----------|-----------|-------|-------------|
| `return_val` | output | 32 bits | Function return value (present if function returns a value) |

## Example Module Headers

### For a GCD Function
```verilog
module gcd (
    input   [31:0] a,
    input   [31:0] b,
    output  [31:0] return_val,
    input   sys_clk,
    input   sys_rst_n
);
```

### For a Dot Product Function
```verilog
module dotprod (
    input   [31:0] n,
    output  [31:0] return_val,
    input   sys_clk,
    input   sys_rst_n
);
```
With internal array declarations:
```verilog
reg [31:0] a_mem [0:255];
reg [31:0] b_mem [0:255];
```

### For a Sum Function
```verilog
module sum (
    input   [31:0] a,
    input   [31:0] b,
    output  [31:0] return_val,
    input   sys_clk,
    input   sys_rst_n
);
```

## Internal Control Signals

The following internal signals are generated to control the execution flow:

| Signal Name | Type | Width | Description |
|-------------|------|-------|-------------|
| `cur_state` | reg | N bits | Current state of the FSM (N depends on number of basic blocks) |
| `last_state` | reg | N bits | Previous state of the FSM |
| `branch_ready` | reg | 1 bit | Flag indicating if a branch operation is ready |
| `counter` | reg | 32 bits | Cycle counter for operation scheduling |
| `ret` | reg | 32 bits | Internal register storing return value |

## State Machine Structure

The generated modules implement a state machine where:
- Each basic block from the LLVM IR corresponds to a state
- Operations are scheduled into clock cycles
- Transition between states is controlled by branch conditions
- Array accesses are handled through memory read/write operations

The modules follow a standardized implementation pattern that enables consistent testbench generation and verification.